<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>アンケート</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .transition {
      transition: transform 0.2s ease, color 0.2s ease;
    }
    .bg-question1 {
      background-image: url('https://image.co-trip.jp/content/14renewal_images_l/687519/main_image_20250411121542108.jpg');
      background-size: cover;
      background-position: center;
    }
    .bg-question2 {
      background-image: url('https://tabiyomi.yomiuri-ryokou.co.jp/uploads/2024/12/10/c61fd26459e36c4633136fbf760a4d832c059671.jpg');
      background-size: cover;
      background-position: center;
    }
    .bg-question3 {
      background-image: url('https://prtimes.jp/i/23462/409/resize/d23462-409-b6f0f90c18c4ad6c39a0-0.jpg');
      background-size: cover;
      background-position: center;
    }
    .bg-question4 {
      background-image: url('');
      background-size: cover;
      background-position: center;
    }
    .bg-question5 {
      background-image: url('');
      background-size: cover;
      background-position: center;
    }
  </style>
</head>
<body class="bg-gray-100 text-gray-800 p-4 sm:p-8">

  <div class="max-w-3xl mx-auto bg-white p-6 sm:p-10 rounded-xl shadow-md">
    <h1 class="text-2xl sm:text-3xl font-bold mb-6 text-center">ア</h1>
    <form id="surveyForm" class="space-y-6">

      <!-- 質問カード（背景付き） -->
      <div class="p-6 rounded-xl shadow bg-question1 bg-opacity-10 backdrop-blur-sm border border-gray-300 rating-group" data-question="q1">
        <p class="mb-4 font-semibold text-lg bg-white bg-opacity-70 p-2 rounded text-center">万博</p>
        <div class="flex justify-between sm:justify-around">
          <label class="rating-icon cursor-pointer text-2xl transition" data-value="1">😡</label>
          <label class="rating-icon cursor-pointer text-2xl transition" data-value="2">😕</label>
          <label class="rating-icon cursor-pointer text-2xl transition" data-value="3">😐</label>
          <label class="rating-icon cursor-pointer text-2xl transition" data-value="4">🙂</label>
          <label class="rating-icon cursor-pointer text-2xl transition" data-value="5">😍</label>
        </div>
        <input type="hidden" name="q1" />
      </div>

      <div class="p-6 rounded-xl shadow bg-question2 bg-opacity-10 backdrop-blur-sm border border-gray-300 rating-group" data-question="q2">
        <p class="mb-4 font-semibold text-lg bg-white bg-opacity-70 p-2 rounded text-center">伊勢神宮</p>
        <div class="flex justify-between sm:justify-around">
          <label class="rating-icon cursor-pointer text-2xl transition" data-value="1">😡</label>
          <label class="rating-icon cursor-pointer text-2xl transition" data-value="2">😕</label>
          <label class="rating-icon cursor-pointer text-2xl transition" data-value="3">😐</label>
          <label class="rating-icon cursor-pointer text-2xl transition" data-value="4">🙂</label>
          <label class="rating-icon cursor-pointer text-2xl transition" data-value="5">😍</label>
        </div>
        <input type="hidden" name="q2" />
      </div>

      <div class="p-6 rounded-xl shadow bg-question3 bg-opacity-10 backdrop-blur-sm border border-gray-300 rating-group" data-question="q3">
        <p class="mb-4 font-semibold text-lg bg-white bg-opacity-70 p-2 rounded text-center">ハウステンボス</p>
        <div class="flex justify-between sm:justify-around">
          <label class="rating-icon cursor-pointer text-2xl transition" data-value="1">😡</label>
          <label class="rating-icon cursor-pointer text-2xl transition" data-value="2">😕</label>
          <label class="rating-icon cursor-pointer text-2xl transition" data-value="3">😐</label>
          <label class="rating-icon cursor-pointer text-2xl transition" data-value="4">🙂</label>
          <label class="rating-icon cursor-pointer text-2xl transition" data-value="5">😍</label>
        </div>
        <input type="hidden" name="q3" />
      </div>

      <div class="p-6 rounded-xl shadow bg-question4 bg-opacity-10 backdrop-blur-sm border border-gray-300 rating-group" data-question="q4">
        <p class="mb-4 font-semibold text-lg bg-white bg-opacity-70 p-2 rounded text-center"></p>
        <div class="flex justify-between sm:justify-around">
          <label class="rating-icon cursor-pointer text-2xl transition" data-value="1">😡</label>
          <label class="rating-icon cursor-pointer text-2xl transition" data-value="2">😕</label>
          <label class="rating-icon cursor-pointer text-2xl transition" data-value="3">😐</label>
          <label class="rating-icon cursor-pointer text-2xl transition" data-value="4">🙂</label>
          <label class="rating-icon cursor-pointer text-2xl transition" data-value="5">😍</label>
        </div>
        <input type="hidden" name="q4" />
      </div>

      <div class="p-6 rounded-xl shadow bg-question5 bg-opacity-10 backdrop-blur-sm border border-gray-300 rating-group" data-question="q5">
        <p class="mb-4 font-semibold text-lg bg-white bg-opacity-70 p-2 rounded text-center"></p>
        <div class="flex justify-between sm:justify-around">
          <label class="rating-icon cursor-pointer text-2xl transition" data-value="1">😡</label>
          <label class="rating-icon cursor-pointer text-2xl transition" data-value="2">😕</label>
          <label class="rating-icon cursor-pointer text-2xl transition" data-value="3">😐</label>
          <label class="rating-icon cursor-pointer text-2xl transition" data-value="4">🙂</label>
          <label class="rating-icon cursor-pointer text-2xl transition" data-value="5">😍</label>
        </div>
        <input type="hidden" name="q5" />
      </div>

      <!-- 他の質問も同じように追加 -->

      <div class="text-center">
        <button type="submit" class="bg-blue-600 text-white px-6 py-2 rounded hover:bg-blue-700">送信</button>
      </div>
    </form>

    <!-- 結果表示 -->
    <div id="result" class="mt-6 hidden bg-green-100 text-green-800 p-4 rounded text-center">
      ご回答ありがとうございました！
    </div>
  </div>

  <!-- JavaScript -->
  <script>
    document.querySelectorAll('.rating-group').forEach(group => {
      const icons = group.querySelectorAll('.rating-icon');
      const input = group.querySelector('input[type="hidden"]');

      icons.forEach(icon => {
        icon.addEventListener('click', () => {
          // 全てリセット
          icons.forEach(i => i.classList.remove('text-yellow-500', 'scale-125'));

          // 選ばれたアイコンにスタイル追加
          icon.classList.add('text-yellow-500', 'scale-125');

          // 値を設定（ここが重要！）
          input.value = icon.dataset.value;

          // 赤いハイライトがあれば削除（未回答エラーの解除）
          group.classList.remove('ring-4', 'ring-red-400');
        });
      });
    });

    // フォーム送信イベント処理（Googleフォーム連携用に変更可能）
    document.getElementById('surveyForm').addEventListener('submit', function(e) {
  e.preventDefault();

    const formData = new FormData(this);
    const data = {};
    let valid = true; // 未回答チェック用

    // バリデーション：未入力の質問があるかチェック
    const questions = document.querySelectorAll('.rating-group');
    questions.forEach(group => {
      const input = group.querySelector('input[type="hidden"]');
      const questionName = input.name;

      if (!input.value) {
        valid = false;

        // 視覚的に未回答箇所をハイライト
        group.classList.add('ring-4', 'ring-red-400');
      } else {
        group.classList.remove('ring-4', 'ring-red-400');
        data[questionName] = input.value;
      }
    });

    if (!valid) {
      return;
    }

    // Google Apps Script に送信
    fetch('https://script.google.com/macros/s/AKfycbwFGHNuo9gEdYeJX7a2omUmT5Y0a-aYy9y1Td2lI3pjVojaHaKtnRa7Skaa2xzOJ0cw/exec', {
      method: 'POST',
      mode: 'no-cors',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify(data),
    });

    // サンクスメッセージ表示
    document.getElementById('result').classList.remove('hidden');

    // フォームを初期化
    this.reset();

    // hidden入力とアイコンのスタイルをリセット
    questions.forEach(group => {
      const input = group.querySelector('input[type="hidden"]');
      input.value = ""; // hiddenフィールドを明示的にクリア

      const icons = group.querySelectorAll('.rating-icon');
      icons.forEach(icon => {
        icon.classList.remove('text-yellow-500', 'scale-125');
      });

      group.classList.remove('ring-4', 'ring-red-400');
    });
  });

  </script>
</body>
</html>
